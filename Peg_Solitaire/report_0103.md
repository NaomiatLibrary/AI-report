# 人工知能2020 第一回レポート 第3問

## 1.問題定義

[ペグソリティア](https://www.webgamesonline.com/peg-solitaire/ )を幅優先探索・深さ優先探索・A*探索で解き、探索の効率を比較する。

## 2.アルゴリズム・ソースコードの説明

今回のソースコードは、教科書の説明を見てC++でオリジナルの実装をした。
### 2.0.コンパイル
以下のようにしてコンパイルする。
```
$ g++ -std=c++14 -DPROBLEM_<問題記号> <プログラム名>.cpp
$ ./a.out
```
<問題記号>に解きたい問題の記号(A,B,C,D)を入れて、<プログラム名>に動かしたい探索方法のプログラムファイルを以下のように指定する。
|探索法|プログラム名|
| ---- | ---- |
|幅優先探索| bfs|
|深さ優先探索 | dfs |
|A*探索 | Astar|
実行すると、正解となる動かし方が逆順に表示され、そのあとに解を見つけるまでに展開したノード数が表示される。
### 2.1.幅優先探索
幅優先探索とは、探索する木の一定の深さに存在するノード全てを調べてから、次の深さのノードを展開して調べていくという探索方法である。

`bfs.cpp`に幅優先探索のプログラムを記述した。関数`bfs`内で、キューがFIFOであることを用いて幅優先探索を行なっている。
### 2.2.深さ優先探索
深さ優先探索とは、探索する木を最深部（手詰まりになるところ）まで探索してから、バックトラックを行い他の経路を探索する探索方法である。

`dfs.cpp`に深さ優先探索のプログラムを記述した。再帰関数`dfs`で再帰的に深いノードまで潜っていくことで、深さ優先探索を行なっている。
### 2.3.A*探索
A*探索とは、木の各ノードを$f$値というヒューリスティクスを用いた評価関数で評価し、$f$値が最も小さいノードから先に探索するというアルゴリズムである。

$f$値とは、ノードnの深さを$d(n)$とし、関数$h(n)$を用いて、
$$f(n)=d(n)+h(n)$$
で求められる値のことである。ここで、$h(n)$が最短経路の長さの下界を与える関数である時、A*は必ず終了し、かつ最適な答えを見つけることが保証されている。


`Astar.cpp`にA*探索のプログラムを記述した。優先度付きキュー(priority_queue)に、$f$値、深さ、ノードが示す状態をセットにして入れることによって、到達可能なノードを$f$値によってソーティングし、$f$値が小さいものから取り出すことを実現している。また、展開するノードの$f$値は関数`h_calc`によって計算された$h(n)$の値とキューに保存されていた現在のノードの深さ+1(=展開するノードの深さ)を足し合わせることによって計算さえている。
#### 2.3.1.ヒューリスティクス
ここで、$h(n)$が最短経路の長さの下界を与える関数でなくても、問題A~Dに対してA*は必ず終了し、かつ最適な答えを見つけることが保証されていることを示す。まず、一回操作をすると一つ駒の数が減ることから、問題A~Dのグラフは深さが高々(最終状態の駒の数)-(初期状態の駒の数)しかなく有限であるため、終了する。また、一回操作をすると一つ駒の数が減ることから、解が存在するときその手数は必ず(最終状態の駒の数)-(初期状態の駒の数)と等しいため、どの解を見つけた時も最適な答えを得ている。
よって、ヒューリスティクス関数としてどのような関数を考えても、効率は悪いかもしれないが、一応最適解を得られることがわかる。最適経路の下界となる関数を考えるのは難しいため、ここでは下界とならないものも用いることとする。

私は以下のようなヒューリスティクス関数を考え、試した。
1. 残りのコマ数
2. 終了状態と違うところにあるコマの数
3. 最後に残る駒の位置をXとする。Xからの距離の合計。ただしここでの距離はL1ノルムを指す。
4. 最後に残る駒の位置をXとする。Xからの距離の合計。ただしここでの距離は、$(x_1,y_1),(x_2,y_2)$に対して、$|x_1-x_2|//2+|y_1-y_2|//2$とする。(//は商を表す。)

この4つの関数で試した。
## 3.結果

### 3.1.導かれた答え
長くなってしまうので、最後の付録に記載する。
### 3.2.探索の効率比較

解に到達するまでのノードの展開数を比較すると、以下のようになった。xは一定時間内に終了しなかったものを表す。また、各問題で最も効率的に探索を行えたものを太字で表した。
| 問題(手数) | DFS| BFS| A*(1) | A*(2)| A*(3) | A*(4) |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- |
|A(3)|12|13|13|9|**4**|**4**|
|B(7)|354|282|282|196|**11**|242|
|C(7)|97|81|81|57|**8**|**8**|
|D(19)|x|x|x|x|x|**20**|


## 4.結果に対する考察と評価
主にA*のヒューリスティクス関数についての評価を行う。
### 関数1について
まず、(1)残りのコマ数　を用いた時は幅優先探索と全く同じ結果になった。これについて示す。まず、私のA*の実装では実装の都合上、$f$値が同じ時は深さによってキュー内のノードがソートされるようになっている。そして、$f$値=(深さ)+(残りのコマ数)=(初期状態のコマ数)となるので、一定である。なぜなら木の深さが一つ深くなる、つまり一回の操作をするごとに一つコマ数が減るからである。よって、幅優先探索になってしまう。
### 関数2について
関数1よりも少し少なくなったが、この関数において知識量が関数1より多い部分としては、終了状態の駒の上に駒があるかどうかを判定できるのみであり、他はほとんど同じである。おそらくこの展開ノード数の変化は、実装の都合上そのノードに実際に到達してから終了状態と一致しているかどうかを調べているので、終了状態の駒の上に駒があるかどうかを判定できるようになったことにより、答えのノードに到達するのが他の全ての同じ深さのノードよりも早くなったためだと思われる。
### 関数3,4について
問題A,Cではどちらの関数も手数+1という非常に効率の良い結果となった。
問題Bにおいて、関数3が比較的効率の良い探索を行っているにも関わらず、関数4の効率があまり良くなっていないのは、距離として2で割った商を求めているため、深さが深くなるのに対して距離の合計が小さくなる速度が遅すぎて、幅優先探索と同じようになっているからだと思われる。
問題Dにおいて、関数3に比べて関数4の方が圧倒的に早く終了したのは驚いた。距離の求め方を変更しただけであるが、これがなぜ問題Dにおいて効率的な探索につながったかはわからないが、一回の操作で二つの駒の位置を変更できるので、それが関係しているかもしれない。

## 5.参考文献
「人工知能の方法-ゲームからWWWまで-」　伊庭斉志　コロナ社

## 6.付録
3.1.章に述べたように。A~D問題の解法を付録とした。A*探索で探索した結果をそのまま貼り付ける。
### A問題
```
phase 0
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | |*| |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 1
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | |*| |
+-+-+-+-+-+
| | | |*| |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 2
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | |*| |
+-+-+-+-+-+
| |*|*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 3
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| |*|*|*| |
+-+-+-+-+-+
| | | |*| |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
```
### B問題
```
phase 0
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
phase 1
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| |*|*| | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
phase 2
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| |*| |*|*| | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
phase 3
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| |*| | |*| | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
phase 4
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | |*|*|*| | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
| | | | | | | |
+-+-+-+-+-+-+-+
phase 5
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | |*| |*| | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
phase 6
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | |*| | |*|*|
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
phase 7
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
|*|*| | | |*|*|
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
| | | |*| | | |
+-+-+-+-+-+-+-+
```
### C問題
```
phase 0
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 1
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 2
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 3
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | |*|*|
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 4
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | |*|*|*|
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 5
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
|*|*| |*|*|
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
phase 6
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
|*|*| |*|*|
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
phase 7
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
| | | | | |
+-+-+-+-+-+
|*|*|*|*|*|
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
| | |*| | |
+-+-+-+-+-+
```
### D問題
```
phase 0
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 1
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 2
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*|*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 3
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 4
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 5
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*| |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 6
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 7
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 8
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 9
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| |*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 10
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 11
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*| |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 12
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | |*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 13
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*| | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 14
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 15
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*| | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*|*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 16
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*| | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*| |*|*| |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*| | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 17
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*| | | |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*| |*|*| |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*| |*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*|*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 18
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*| | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*|*|*|*| |
+-+-+-+-+-+-+-+-+-+-+
| | | |*|*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*|*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
phase 19
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*|*|*|*| |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*|*|*| | |
+-+-+-+-+-+-+-+-+-+-+
| | |*|*|*|*|*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | |*| |*| | | |
+-+-+-+-+-+-+-+-+-+-+
| | | | | | | | | | |
+-+-+-+-+-+-+-+-+-+-+
```